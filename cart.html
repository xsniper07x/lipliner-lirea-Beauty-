<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cart</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 800px; margin: auto; padding: 20px; background:#f9f9f9; }
  h2 { text-align:center; color:#333; }
  #cart ul { list-style:none; padding:0; }
  #cart li { display:flex; justify-content:space-between; align-items:center; padding:10px; border-bottom:1px solid #ddd; background:white; border-radius:8px; margin-bottom:10px; }
  #cart li span { font-weight:500; }
  button { cursor:pointer; padding:6px 12px; border:none; border-radius:5px; font-size:14px; transition:0.2s; }
  .remove-btn { background:#e74c3c; color:white; }
  .remove-btn:hover { background:#c0392b; }
  .qty-btn { background:#25d366; color:white; margin:0 3px; }
  .qty-btn:hover { background:#1ebe57; }
  #clearCart { background:#f39c12; color:white; margin-right:10px; }
  #clearCart:hover { background:#d68910; }
  #sendWhatsApp { background:#075e54; color:white; }
  #sendWhatsApp:hover { background:#0a7d60; }
  #cartActions { margin-top:20px; text-align:center; }
</style>
</head>
<body>

<h2>Your Cart</h2>
<div id="cart"></div>

<div id="cartActions">
  <button id="clearCart">Clear Cart</button>
  <button id="sendWhatsApp">Send via WhatsApp</button>
</div>

<script>
let cart = JSON.parse(localStorage.getItem('cart')) || [];

function renderCart() {
  const cartDiv = document.getElementById("cart");
  if(cart.length === 0) {
    cartDiv.innerHTML = "<p style='text-align:center;'>Your cart is empty.</p>";
    return;
  }

  let total = 0;
  cartDiv.innerHTML = "<ul>";
  cart.forEach((item, index) => {
    total += item.price * item.qty;
    cartDiv.innerHTML += `
      <li>
        <span>${item.name} x ${item.qty} - $${item.price*item.qty}</span>
        <div>
          <button class="qty-btn" onclick="changeQty(${index}, 1)">+</button>
          <button class="qty-btn" onclick="changeQty(${index}, -1)">-</button>
          <button class="remove-btn" onclick="removeItem(${index})">x</button>
        </div>
      </li>
    `;
  });
  cartDiv.innerHTML += `</ul><p style="text-align:right; font-weight:bold; margin-top:10px;">Total: $${total}</p>`;
}

function changeQty(index, delta) {
  cart[index].qty += delta;
  if(cart[index].qty <= 0) cart.splice(index,1);
  localStorage.setItem('cart', JSON.stringify(cart));
  renderCart();
}

function removeItem(index) {
  cart.splice(index,1);
  localStorage.setItem('cart', JSON.stringify(cart));
  renderCart();
}

document.getElementById("clearCart").addEventListener("click", () => {
  cart = [];
  localStorage.removeItem('cart');
  renderCart();
});

document.getElementById("sendWhatsApp").addEventListener("click", () => {
  if(cart.length === 0) return alert("Cart is empty!");

  // Encode each line individually, join with %0A for WhatsApp
  let messageLines = cart.map(item => encodeURIComponent(`${item.name} x ${item.qty} - $${item.price*item.qty}`));
  let total = cart.reduce((sum,item) => sum + item.price*item.qty,0);
  let message = messageLines.join('%0A') + '%0A%0ATotal: $' + total;

  // WhatsApp link (replace with your active WhatsApp number)
  let whatsappURL = "https://wa.me/96178783516?text=" + message;
  window.open(whatsappURL, "_blank");
});

renderCart();
</script>

</body>
</html>
